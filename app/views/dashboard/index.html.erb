<h1>Kudos Feed ğŸ‰</h1>

<p>
  <%= link_to "â• Send a Kudo", new_kudo_path, class: "send-kudo-link" %>
</p>

<% if @kudos.any? %>
  <ul>
    <% @kudos.each do |kudo| %>
      <li>
        <strong><%= kudo.sender.username %></strong>
        â†’ <strong><%= kudo.receiver.username %></strong><br>

        <em><%= kudo.category %></em><br>

        <p><%= kudo.message %></p>

        <small>
          <%= kudo.created_at.strftime("%d %b %Y %H:%M") %>
        </small>
      </li>
      <hr>
    <% end %>
  </ul>
<% else %>
  <p>No kudos yet.</p>
<% end %>

<hr>

<h2>ğŸ† Top 3 Kudos Leaders</h2>
<ul>
  <% User.joins(:received_kudos)
         .group("users.id")
         .order("COUNT(kudos.id) DESC")
         .limit(3)
         .each do |user| %>
    <li style="<%= 'font-weight: bold; color: green;' if user == current_user %>">
      <%= user.username %> (<%= user.received_kudos.count %> kudos)
      <% if user == current_user %>
        â† You!
      <% end %>
    </li>
  <% end %>
</ul>

<p>
  <%= link_to "View Full Leaderboard", leaderboard_path %>
</p>

<hr>

<h2>My Kudos ğŸ’Œ</h2>

<% if @received_kudos.any? %>
  <ul>
    <% @received_kudos.each do |kudo| %>
      <li>
        <strong>From:</strong> <%= kudo.sender.username %><br>

        <em><%= kudo.category %></em>

        <p><%= kudo.message %></p>

        <small>
          <%= kudo.created_at.strftime("%d %b %Y %H:%M") %>
        </small>
      </li>
      <hr>
    <% end %>
  </ul>
<% else %>
  <p>You havenâ€™t received any kudos yet ğŸŒ±</p>
<% end %>
